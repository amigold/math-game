<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game Lobby - Math Learning Games</title>

    <!-- Stylesheets -->
    <link rel="stylesheet" href="styles/common.css">
    <link rel="stylesheet" href="styles/lobby.css">
    <link rel="stylesheet" href="styles/mathOrb.css">
    <link rel="stylesheet" href="styles/hebrewMatch.css">
</head>
<body>
    <!-- Lobby View -->
    <div id="lobby-view" class="lobby-container">
        <div class="lobby-header">
            <h1>Game Lobby</h1>
            <p>Choose a game to play</p>
        </div>

        <div class="game-cards">
            <!-- Math Orb Game Card -->
            <div class="game-card" data-game="mathOrb">
                <div class="game-card-icon">â•</div>
                <h2>Math Orb Collector</h2>
                <p>Practice addition and collect prizes!</p>
                <button class="play-button">Play</button>
            </div>

            <!-- Hebrew Learning Game Card -->
            <div class="game-card" data-game="hebrewLearn">
                <div class="game-card-icon">ğŸš—</div>
                <h2>××©×—×§ ×”×©×¤×”</h2>
                <p>×”×ª×× ×›×œ×™ ×ª×—×‘×•×¨×” ×•××¡×•×£ ×¤××–×œ×™×!</p>
                <button class="play-button">×©×—×§</button>
            </div>
        </div>
    </div>

    <!-- Math Orb Game View -->
    <div id="math-game-view" class="hidden">
        <!-- Exit Button -->
        <button id="exit-button" class="exit-button" title="Exit to Lobby">
            <span class="exit-icon">â†</span>
            <span class="exit-text">Exit</span>
        </button>

        <div class="game-container">
            <!-- Countdown Overlay -->
            <div id="countdown-overlay" class="countdown-overlay hidden">
                <div id="countdown-text" class="countdown-text"></div>
            </div>

            <!-- Challenge Timer -->
            <div id="challenge-timer" class="challenge-timer hidden">
                <div class="timer-label">Time Left:</div>
                <div id="timer-display" class="timer-display">2:00</div>
                <div class="problems-counter">
                    Problems: <span id="problems-counter">0</span>/3
                </div>
            </div>

            <!-- Game area where orbs appear -->
            <div class="game-area">
                <div id="orb-container" class="orb-container">
                    <!-- Orb will be dynamically created here -->
                </div>

                <!-- Input area -->
                <div class="input-area">
                    <input type="number" id="answer-input" placeholder="?" autocomplete="off" autofocus>
                    <button id="check-button">Check</button>
                </div>

                <!-- Feedback message -->
                <div id="feedback-message" class="feedback-message"></div>
            </div>

            <!-- Collection sidebar -->
            <div class="collection-sidebar">
                <h2>My Collection</h2>
                <div id="emoji-collection" class="emoji-grid">
                    <!-- Collected emojis will appear here -->
                </div>
                <div class="collection-count">
                    Collected: <span id="collection-count">0</span>
                </div>

                <div class="magic-section">
                    <h2>Magic Faces</h2>
                    <div id="magic-face-collection" class="emoji-grid magic-grid">
                        <!-- Magic face emojis will appear here -->
                    </div>
                    <div class="collection-count magic-count">
                        Magic Faces: <span id="magic-count">0</span>
                    </div>
                </div>

                <div class="picture-section">
                    <h2>Picture Gallery</h2>
                    <div id="picture-collection" class="picture-grid">
                        <!-- Collected pictures will appear here -->
                    </div>
                    <div class="collection-count picture-count">
                        Pictures: <span id="picture-count">0</span>
                    </div>
                </div>

                <button id="reset-button" class="reset-button">Reset Collection</button>
            </div>
        </div>
    </div>

    <!-- Hebrew Matching Game View -->
    <div id="hebrew-game-view" class="hidden">
        <!-- Exit Button -->
        <button id="hebrew-exit-button" class="exit-button" title="×—×–×¨×” ×œ×œ×•×‘×™">
            <span class="exit-icon">â†</span>
            <span class="exit-text">×—×–×¨×”</span>
        </button>

        <!-- Level Selection Screen -->
        <div id="level-selection" class="hebrew-screen">
            <div class="hebrew-header">
                <h1>××©×—×§ ×”×”×ª×××”</h1>
                <p>×‘×—×¨ ×©×œ×‘ ×œ×©×—×§</p>
            </div>
            <div class="level-grid">
                <div class="level-card" data-level="1">
                    <div class="level-number">1</div>
                    <div class="level-status"></div>
                </div>
                <div class="level-card" data-level="2">
                    <div class="level-number">2</div>
                    <div class="level-status"></div>
                </div>
                <div class="level-card" data-level="3">
                    <div class="level-number">3</div>
                    <div class="level-status"></div>
                </div>
                <div class="level-card" data-level="4">
                    <div class="level-number">4</div>
                    <div class="level-status"></div>
                </div>
            </div>
            <button id="show-collection-btn" class="collection-btn">×”××•×¡×£ ×©×œ×™</button>
        </div>

        <!-- Matching Game Screen -->
        <div id="matching-game" class="hebrew-screen hidden">
            <button id="show-collection-from-game" class="collection-btn-ingame">×”××•×¡×£ ×©×œ×™</button>
            <div class="hebrew-header">
                <h2 id="matching-title">×©×œ×‘ 1</h2>
                <p>×”×ª×× ×›×œ ×›×œ×™ ×ª×—×‘×•×¨×” ×œ×©× ×©×œ×•</p>
            </div>
            <div class="matching-container">
                <canvas id="line-canvas"></canvas>
                <div class="emoji-column">
                    <!-- Emojis will be added here -->
                </div>
                <div class="name-column">
                    <!-- Names will be added here -->
                </div>
            </div>
            <div id="matching-feedback" class="feedback-message"></div>
        </div>

        <!-- Puzzle Assembly Screen -->
        <div id="puzzle-game" class="hebrew-screen hidden">
            <div class="hebrew-header">
                <h2>×”×¨×›×‘ ××ª ×”×¤××–×œ!</h2>
                <p>×’×¨×•×¨ ××ª ×”×—×ª×™×›×•×ª ×œ××§×•× ×”× ×›×•×Ÿ</p>
            </div>
            <div class="puzzle-container">
                <div class="puzzle-board">
                    <div class="puzzle-slot" data-position="0"></div>
                    <div class="puzzle-slot" data-position="1"></div>
                    <div class="puzzle-slot" data-position="2"></div>
                    <div class="puzzle-slot" data-position="3"></div>
                </div>
                <div class="puzzle-pieces">
                    <!-- Puzzle pieces will be added here -->
                </div>
            </div>
            <div id="puzzle-feedback" class="feedback-message"></div>
        </div>

        <!-- Collection Screen -->
        <div id="collection-screen" class="hebrew-screen hidden">
            <div class="hebrew-header">
                <h1>×”××•×¡×£ ×©×œ×™</h1>
                <p>×›×œ ×”×¤××–×œ×™× ×©×”×©×œ××ª×™</p>
            </div>
            <div class="collection-grid" id="puzzle-collection">
                <!-- Completed puzzles will be shown here -->
            </div>
            <button id="back-to-levels-btn" class="back-btn">×—×–×¨×” ×œ××©×—×§</button>
        </div>
    </div>

    <!-- Core Scripts -->
    <script src="gameManager.js"></script>
    <script src="lobby.js"></script>

    <!-- Game Scripts -->
    <script src="games/mathOrb/pictures.js"></script>
    <script src="games/mathOrb/mathOrbGame.js"></script>
    <script src="games/hebrewMatch/hebrewMatchGame.js"></script>

    <!-- Game Registration -->
    <script>
        // Register Math Orb Game with the Game Manager
        document.addEventListener('DOMContentLoaded', () => {
            gameManager.registerGame('mathOrb', {
                viewId: 'math-game-view',
                title: 'Math Orb Collector',
                createInstance: () => {
                    const game = new MathOrbGame();
                    return game;
                }
            });

            gameManager.registerGame('hebrewLearn', {
                viewId: 'hebrew-game-view',
                title: '××©×—×§ ×”×©×¤×”',
                createInstance: () => {
                    const game = new HebrewMatchGame();
                    return game;
                }
            });

            console.log('âœ“ All games registered');
        });
    </script>
</body>
</html>
